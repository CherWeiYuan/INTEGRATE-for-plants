# LintegrateR

## Introduction
LintegrateR is an automated crRNA design programme for the transposon-associated CRISPR-Cas system described by Klompe et al. (2019) [https://doi.org/10.1038/s41586-019-1323-z]

LintegrateR designs crRNAs in eukaryotes for exon tagging (e.g. adding GFP to the end of specific exons). 
The crRNA guides the CRISPR-Cas complex to the target site where transposases insert the transposon. 
The inserted transposon has the following architecture: L_seq - Cargo_seq - R_seq. 

If the transposon is inserted at the 3' end of an exon, L_seq consists of multiple stop codons that prevents the expression of the GFP tag.

![alt text](https://raw.githubusercontent.com/CherWeiYuan/LintegrateR/master/Figure/Figure_Intron_engineering_A.png)

Our solution is intron-engineering: remove L_seq by making it an intron.
A conserved intron has the following architecture (gt-a-ag):

![alt text](https://raw.githubusercontent.com/CherWeiYuan/LintegrateR/master/Figure/Figure_Intron_engineering_B.png)

Our Cargo_seq has the following architecture: L_seq-a-UBI_intron-ag-GFP-R_seq. When our Cargo_seq is inserted behind an the 3' GT of an exon, the L_seq should be excised as an intron:

![alt text](https://raw.githubusercontent.com/CherWeiYuan/LintegrateR/master/Figure/Figure_Intron_engineering_C.png)

We validate the intron excision of L_seq in-silico using NetGene2 prediction. 

LintegrateR will take the gene sequence (Genbank file .gb), extract its exon positions (if available, otherwise require manual input via editing of python script), scan the exons to select the ones viable for exon-tagging, output the exons and the desired intron excision sites for checking in NetGene2 (http://www.cbs.dtu.dk/services/NetGene2/).
LintegrateR selects viable exons by the following requirements:

1. PAM requirement ('GT','CC','CA','CT') is met
2. 32-bp crRNA, which is located 49 bp before the insertion site
3. If the tag (e.g. GFP), after insertion, can be translated properly in-frame

## Quick start

![alt text](https://raw.githubusercontent.com/CherWeiYuan/LintegrateR/master/Figure/Figure_LintegrateR.png)

Input: Gene sequence in Genbank format (.gb), exon positions if not available in .gb file (edit accordingly in python script)

Sample output:

```
--------------------Exon number: 7---------------------
The 32-bp crRNA is ATGTCAAAGGCGCTAAACTTTATAAACCCTGA

The PAM is CA

Desired donor splice sites, direct strand:
exon ^ intron
GTTTCTTCAG^GTTTGATGTT

Desired acceptor splice sites, direct strand:
intron ^ exon
tttcttgcAG^gtaatggtga

--------------------Exon number: 10---------------------
The 32-bp crRNA is GCAGGTCTTAACTGCTGTGAACTAATATTGCA

The PAM is GT

Desired donor splice sites, direct strand:
exon ^ intron
TCTTTAGCAG^GTGAATTGTT

Desired acceptor splice sites, direct strand:
intron ^ exon
tttcttgcAG^gtaatggtga


***Please conduct the following checks:
1. If desired intron sequence is predicted to be correctly spliced out by NetGene2.
2. Cargo frame to be used.
3. No BsaI or BpiI sites in your cargo.

You may use retrieve(exon_number, *arg) to retrieve data,
where arg is either 'crrna', 'pam','seq' or a combination.
For example, use retrieve(10, 'seq') to output the genomic sequence with insertion,
which is handy for checking the frame of cargo to use in Snapgene

retrieve(10, 'seq')
CTTTGGTGGGCAAAAACATATTAGCTGAGAGGTCAATTTCTTTTTCCCCTAAACCAAATTACGTTGAGATGCATGGTCTCTCTCTACTCAATTAACCAAATAAGGAAAAGAATCATATGGTCATCAATTCGTAAATCAAAATTTTAATTTGTGTGGTATTTAATCCATCTACATGTTTCGTAAGCAACAAAAGAGCTTGGTCTGAAAACCAAACAAGACCATATGGGCACTCGAATACTCCATTTTGTTATCGGCTACTTCCACTAGCCTCCTCCTTCGCTGCGTCTCCTGTTTCTCTACTTCACGATTACTCGCTAGGTAAAAGATAAGATACTAAACAACTACTATAGCCCCTTTAATTCAAGTCCGTTTTTTTTTGTTCTTCTTCTTTTCAATTATGTGTTAAAGATACAAACTTTTGTCTGATTTGCTTCCACCGGTTTCACCTAAGATACTCAATTTTCTTACTTTTTGTGTGTTTTGTAATTCTAATTCTTTTATAGCTTCAATTTTTAGATTCATTGAAGCAGTTGTGAGTTAAGTTGGAGAAAATGGTTGTGTTTGGGAATGTTTCTGCGGCGAATTTGCCTTATCAAAACGGGTTTTTGGAGGCACTTTCATCTGGAGGTTGTGAACTAATGGGACATAGCTTTAGGGTTCCCACTTCTCAAGCGCTTAAGACAAGAACAAGGAGGAGGAGTACTGCTGGTCCTTTGCAGGTATCTACCTTTCTGGTTTTTAACTTGGAGTTCTCGAAATTTCATCTAGTGTATAAGTGTAATTTTGATTAAAGAGAGGAAATTGCAGGTAGTTTGTGTGGATATTCCAAGGCCAGAGCTAGAGAACACTGTCAATTTCTTGGAAGCTGCTAGTTTATCTGCATCCTTCCGTAGTGCTCCTCGTCCTGCTAAGCCTTTGAAAGTTGTAATTGCTGGTGCTGGTATGTCTACAACTTCATTTCTTACTGCTTTGTTTGGGATCTGATGGAATTAATGTTCATGTGATGAAGTTCTTTTGGCTCTCAAATAATTGCAGGATTGGCTGGATTGTCAACTGCAAAGTACCTGGCTGATGCAGGCCACAAACCTCTGTTGCTTGAAGCAAGAGATGTTCTTGGTGGAAAGGTACTTTGATTGGTCTCACTTTCCGAATTACTTATTGTTGTTTGCATTTCTCATTCTTATATGATTTGCTGATTCCCAAAGGCTGTACCAATTATGTTTGTGAGACTACAAGGTATAACTAGTGTTTAGAGTGTTACAGCTCCTAGGTACCCAATGTATCTGTCCTGTTTGTTGTATTAGTCTTGTACTGCCCAATTTGTTTTTTATTATGTTCTAATGTCTTCAGTCTTGTGCTACACACCGCACAACCCTTTCCAGTTTCTAGGCTTAATGTGAATCAAATATAGAGTAGTTTACTGGAAGATATCTTTTGGATATATATTTTGTTAAGTTGTTATTGTGTTCTCTGGTTCTTAGGTTAGGTTCTTGTTTGTTCCGTTTTAACAATTTACCTATCTTATTGGAGAGCGATATTTATGATGTGATATTTGTCTTCCTCCAGATAGCTGCATGGAAGGATGAAGATGGGGACTGGTATGAGACTGGTTTACATATTTTCTGTAAGTCCAAAACTCATACCCTCTCTGTTGCTCCCCCAATATATTTGTTACATATATCTTATCAGCTCTACCATCAATTTGAAGAAAGTTGCAAAACACTGGTTAAATTATATTGTATCTTGTTTTCCCTGTTATTACTTTTCGTTACTGATACTCTCTTCATGTTCTTGTTGGAAGTCGGTGCTTATCCGAATGTGCAGAATTTATTTGGAGAACTTGGGATCAATGATCGGTTGCAGTGGAAGGAACACTCCATGATTTTTGCTATGCCAAGTAAACCTGGAGAATTTAGTAGATTTGACTTCCCAGATGTCCTACCAGCACCCTTAAATGGTGAGAGAATAAACTTATCGCATATTCTTACTTGCTAGTCAGCTGTTATAATATTACTGCTTCAAGTAATTAAACTTTTAAACTATCTGATGAAAACAGTGGTTGAACTATTAGTTAGTGGCGCCATGTATTTGGTTTGATAAAATTGGATTAATGTGCACACACTTGTTGAATGTAAAACAAAGTATGATGTAATTGAGTAAAAAAGTGAGGTTAGTAACTATGATGCATGTATTTATTTGTATTGATCAATTCAAGCTAATTATAGATTTTGACATTTAATAGTAATCAAAGAACTGATGAATGTTTGAGGATATGAAGTATCTCCATCTAATTTAGACGTCAGGAAGAACATGGTCATTTGTCTTTCCAAAGTAAGAAATTCTAGATTTTGAGCTTCCCCATACTTTAGGATGGGTAATCAAACTGTAAAATATTGTTACTGGTCAAGGCAAGACGATATAACTGAACTCCGTTGTAGCATTAGCGCTGAAATGTTCTGTGGTTGAATTAATTTGTTTCTGGCAAATAATTAAAGTTGTTGCTGTTGGATTTACGTTGTAGGTATTTGGGCTATTTTGCGGAACAACGAGATGCTGACATGGCCAGAGAAAATAAAGTTTGCTATTGGACTTTTGCCAGCCATGGTCGGCGGTCAGGCTTATGTTGAGGCCCAAGATGGTTTATCAGTCAAAGAATGGATGGAAAAGCAGGCAAGTAGGCTATTGAGTTCACAGTTTCTGTGAGATTCTCGTAAGCATGTTGATGAGCTTAACTTGGTAGAGTAGTTAGCATGCTGAATCATGTAGTGTTGATTTGTCAGCTTTCTTATGGATAGCTCTGACTTTTCTAGTCCATGTGGTTGTTGTGGTTTCATTGTCGTGCATGTGCTTTCACTCAGCAGATAATAATACATTCTGATTAATTGTATACTTGTCCAGGGAGTACCTGAGCGCGTGACCGACGAGGTGTTTATTGCCATGTCAAAGGCGCTAAACTTTATAAACCCTGATGAACTGTCAATGCAATGCATTTTGATAGCTTTGAACCGGTTTCTTCAGGTTTGACACTCTAGCCCTTTATTTCTCTTTGTTCTTCCTTTTGCCTGTCTTTTTGTGAATCTTTATCTCACTGGCAATCATAGTTACCATTCACATGGTCGACATGAAAACTATAATAGAATTTTTTTACCCAAACAATACTTGAGTTTGATGTTGATTAACTTGTACTACCTCATCCCAATAATCAGATGTTTCTCATTTTGAAACTTATTGTGTGTCATAAGCTGCAACAGATGGTTAGGATATTGTGAATTTGCAAATGCAAACTAATATGAACTACATTGACAGGAAAAACATGGTTCCAAGATGGCATTCTTGGATGGTAATCCTCCGGAAAGGCTTTGTATGCCAGTAGTGGATCATATTCGATCACTAGGTGGGGAAGTGCAACTTAATTCTAGGATAAAGAAAATTGAGCTCAATGACGATGGCACGGTTAAGAGTTTCTTACTCACTAATGGAAGCACTGTCGAAGGAGACGCTTATGTGTTTGCCGCTCCAGGTTTACTACCATGCTGTCTTGTGGGTTTAACAATTCATCTGGTATCCTGCTTATTAATATGTTGTTTATGTTTTTCTTGTAGTCGATATCCTGAAGCTCCTTTTACCAGATCCCTGGAAAGAAATACCGTACTTCAAGAAATTGGATAAATTAGTTGGAGTACCAGTTATTAATGTTCATATATGGTTAGTGAAACCGTTATCTCCCTTGTTTTCTTTTGGCCATTATGTGAGAATCGAGATTACATGCAGGTCTTAACTGCTGTGAACTAATATTGCAGGTTTGATCGAAAACTGAAGAACACATATGATCACCTACTCTTTAGCAGGTGAATTGTTGATGCAACCATAAAGTGATATTTAATAATTATTTATAATCAGCAACTTAACCACAAAACAACCATATATTGATATCTCACAAAACAACCATAAGTTGATATTTTTGTGAATCGAGTATTTCAGCAAAACTACTGCAGTAAGgactctagaCTAATttatttcttgcAGgtaatggtgagcaagggcgaggagctgttcaccggggtggtgcccatcctggtcgagctggacggcgacgtaaacggccacaagttcagcgtgtccggcgagggcgagggcgatgccacctacggcaagctgaccctgaagttcatctgcaccaccggcaagctgcccgtgccctggcccaccctcgtgaccaccttcagctacggcgtgcagtgcttcagccgctaccccgaccacatgaagcagcacgacttcttcaagtccgccatgcccgaaggctacgtccaggagcgcaccatcttcttcaaggacgacggcaactacaagacccgcgccgaggtgaagttcgagggcgacaccctggtgaaccgcatcgagctgaagggcatcgacttcaaggaggacggcaacatcctggggcacaagctggagtacaactacaacagccacaacgtctatatcatggccgacaagcagaagaacggcatcaaggtgaacttcaagatccgccacaacatcgaggacggcagcgtgcagctcgccgaccactaccagcagaacacccccatcggcgacggccccgtgctgctgcccgacaaccactacctgagcacccagtccgccctgagcaaagaccccaacgagaagcgcgatcacatggtcctgctggagttcgtgaccgccgccgggatcactcacggcatggacgagctgtacaagtaaggatccccgGAAATGACCTCTTCATGAAAATGTCGTAAACTTACTGAAGTTTAGACCATGAAGAGGCAATATCAATTTATGGGTGTGATAATTATCAATTTATGGGTGTAATTATCATTTTATGGTTGTATCAACATTCTTATTTATGCAGTTTTGAGGAATTATGTCTTATAGAATACTTAGTTGGATACAGTGTTGGAAAAAAAGAATACAAGTGTTTTGTCTTGAATCAGCAACAGTTAAGGCTTGTTCTTGGTTAAACATTTGTTGTATATTCAACAATCTTGTTTTGTTGTTTTTTGCAGAAGTAACCTTCTGAGCGTGTATGCCGACATGTCCTTAACTTGTAAGGTAAGAACGCGGCTTGTTTTTCTAAACGTGTTCCTCCACTTGTTTATCTATCATAAATTGGTGCTCTGTGGATCTTCTCATAATTTTTGATGGCTTATCTTGATTCCGAATCTGATTCAACAAAGCGTTTTCTTTCTATGATAAACTGTAGGAATATTACGATCCTAACCGGTCAATGCTGGAGCTAGTATTTGCACCAGCAGAGGAATGGATATCACGGACTGATTCTGACATCATAGATGCAACAATGAAAGAACTTGAGAAACTCTTCCCTGATGAAATCTCAGCTGACCAAAGCAAAGCTAAAATTCTGAAGTACCATGTCGTTAAGACTCCAAGGTTAGTGAAGTTGTACCATTTATTTAGCTTCAAATGAGGGACCAGGCTTTACATTGATAAATTCAACATCTTTCTCTATTGTTGCATGATCAGATCTGTGTACAAGACCATCCCAAACTGTGAACCATGTCGTCCTCTACAAAGATCACCTATTGAAGGATTCTACTTAGCTGGAGATTACACAAAACAGAAGTACTTAGCTTCCATGGAAGGCGCTGTCCTCTCTGGCAAATTCTGCTCTCAGTCTATTGTTCAGGTAAACACAAGCTTGCCATTCAAATAGTTAACCAGTAACCTTGTTCTCTGTTTCTTGTTGGAATATATCGCCAATAACCGGTCGGTTTACCTGATTTTGTCTCACTATTATACTGTTCCGGTTATGTAGAGAAATTGCTAAAGTCAGAATTTACTGGTTATACAGGATTACGAGCTACTGGCTGCGTCTGGACCAAGAAAGTTGTCGGAGGCAACAGTATCATCATCATGAGAAGAGGACAAAACTTAAAGATGATTTGCTTGTAAGCATTATTATTTGTGTATAAATCTCATTGCAATCCAAACTTAACCTTACTCTCTTCAGTAAATGAATCTCACAGATTTGACATCTCACGTTTCTGTCAATTTTATAATTTTTAAAAAGTAATTACTGTCGACCTTTTGTAATCATAGTGATTTATCATTATGTCTCTCTTTTTAAAACCTTTTCTGGTACAAATTATAAAA
```
